@section Styles{
    <title>Store Single eCommerce HTML Template - FreshCart </title>
    <!-- Favicon icon-->
    <link rel="shortcut icon" type="image/x-icon" href="~/assets/images/favicon/favicon.ico">

    <!-- Libs CSS -->
    <link href="~/assets/libs/bootstrap-icons/font/bootstrap-icons.min.css" rel="stylesheet">
    <link href="~/assets/libs/feather-webfont/dist/feather-icons.css" rel="stylesheet">
    <link href="~/assets/libs/simplebar/dist/simplebar.min.css" rel="stylesheet">

    <!-- Theme CSS -->
    <link rel="stylesheet" href="~/assets/css/theme.min.css">
    <!-- Google tag (gtag.js) -->
                        @* Carousel *@
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
          rel="stylesheet" />
    <!-- Google Fonts -->
                        @* <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
          rel="stylesheet" /> *@
    <!-- MDB -->
                        @* <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.4.2/mdb.min.css"
    rel="stylesheet" /> *@
}

@{
    ViewData["Title"] = "Stores";
}


<body>

    <!-- Modal -->
    <div class="modal fade" id="userModal" tabindex="-1" aria-labelledby="userModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content p-4">
                <div class="modal-header border-0">
                    <h5 class="modal-title fs-3 fw-bold" id="userModalLabel">Sign Up</h5>

                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="mb-3">
                            <label for="fullName" class="form-label">Name</label>
                            <input type="text" class="form-control" id="fullName" placeholder="Enter Your Name" required="">
                        </div>
                        <div class="mb-3">
                            <label for="email" class="form-label">Email address</label>
                            <input type="email" class="form-control" id="email" placeholder="Enter Email address" required="">
                        </div>

                        <div class="mb-5">
                            <label for="password" class="form-label">Password</label>
                            <input type="password" class="form-control" id="password" placeholder="Enter Password" required="">
                            <small class="form-text">
                                By Signup, you agree to our <a href="#!">Terms of Service</a> & <a href="#!">Privacy Policy</a>
                            </small>
                        </div>

                        <button type="submit" class="btn btn-primary">Sign Up</button>
                    </form>
                </div>
                <div class="modal-footer border-0 justify-content-center">

                    Already have an account? <a href="#">Sign in</a>
                </div>
            </div>
        </div>
    </div>



    
    <!-- Modal -->
    <div class="modal fade" id="locationModal" tabindex="-1" aria-labelledby="locationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content">

                <div class="modal-body p-6">
                    <div class="d-flex justify-content-between align-items-start ">
                        <div>
                            <h5 class="mb-1" id="locationModalLabel">Choose your Delivery Location</h5>
                            <p class="mb-0 small">Enter your address and we will specify the offer you area. </p>
                        </div>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="my-5">
                        <input type="search" class="form-control" placeholder="Search your area">
                    </div>
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <h6 class="mb-0">Select Location</h6>
                        <a href="#" class="btn btn-outline-gray-400 text-muted btn-sm">Clear All</a>


                    </div>
                    <div>
                        <div data-simplebar style="height:300px;">
                            <div class="list-group list-group-flush">

                                <a href="#"
                                   class="list-group-item d-flex justify-content-between align-items-center px-2 py-3 list-group-item-action active">
                                    <span>Alabama</span><span>Min:$20</span>
                                </a>
                                <a href="#"
                                   class="list-group-item d-flex justify-content-between align-items-center px-2 py-3 list-group-item-action">
                                    <span>Alaska</span><span>Min:$30</span>
                                </a>
                                <a href="#"
                                   class="list-group-item d-flex justify-content-between align-items-center px-2 py-3 list-group-item-action">
                                    <span>Arizona</span><span>Min:$50</span>
                                </a>
                                <a href="#"
                                   class="list-group-item d-flex justify-content-between align-items-center px-2 py-3 list-group-item-action">
                                    <span>California</span><span>Min:$29</span>
                                </a>
                                <a href="#"
                                   class="list-group-item d-flex justify-content-between align-items-center px-2 py-3 list-group-item-action">
                                    <span>Colorado</span><span>Min:$80</span>
                                </a>
                                <a href="#"
                                   class="list-group-item d-flex justify-content-between align-items-center px-2 py-3 list-group-item-action">
                                    <span>Florida</span><span>Min:$90</span>
                                </a>
                                <a href="#"
                                   class="list-group-item d-flex justify-content-between align-items-center px-2 py-3 list-group-item-action">
                                    <span>Arizona</span><span>Min:$50</span>
                                </a>
                                <a href="#"
                                   class="list-group-item d-flex justify-content-between align-items-center px-2 py-3 list-group-item-action">
                                    <span>California</span><span>Min:$29</span>
                                </a>
                                <a href="#"
                                   class="list-group-item d-flex justify-content-between align-items-center px-2 py-3 list-group-item-action">
                                    <span>Colorado</span><span>Min:$80</span>
                                </a>
                                <a href="#"
                                   class="list-group-item d-flex justify-content-between align-items-center px-2 py-3 list-group-item-action">
                                    <span>Florida</span><span>Min:$90</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!-- section-->
    <main id="storeProductsApp">
        <div class="mt-4">
            <div class="container">
                <!-- row -->
                <div class="row">
                    <!-- col -->
                    <div class="col-12">
                        <!-- breadcrumb -->
                        <nav aria-label="breadcrumb">
                            <ol class="breadcrumb mb-0">
                                <li class="breadcrumb-item"><a href="#!">Home</a></li>
                                <li class="breadcrumb-item"><a href="#!">Stores</a></li>
                                <li class="breadcrumb-item active" aria-current="page">
                                    {{stores.storeName}}
                                </li>
                            </ol>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
        <!-- section -->
        <section class="mb-lg-14 mb-8 mt-8">
            <div class="container">
                <!-- row -->
                <div class="row">
                    <div class="col-12 col-lg-3 col-md-4 mb-4 mb-md-0">
                        <div class="d-flex flex-column">
                            <div>

                                <!-- img -->
                                <img :src="stores.logoPath"
                                     alt=""
                                     class="rounded-circle icon-shape icon-xxl"
                                     style="height:150px; width:auto" />
                            </div>
                            <!-- heading -->
                            <div class="mt-4">
                                <h1 class="mb-1 h4">{{stores.storeName}}</h1>
                                <div class="small text-muted">
                                    <span v-for="storeCategory in storeCategoryList">{{storeCategory}}&nbsp;</span>
                                </div>
                                <!-- Store Address -->
                                <div>
                                    {{stores.address}}
                                </div>
                                <!-- Phone Number -->
                                <div>
                                    {{stores.phone}}
                                </div>
                                <div>
                                    @* <span> *@
                                    <small><a href="#!">{{stores.weekdayOpeningTime}}</a></small>
                                    <br />
                                    <small><a href="#!">{{stores.weekendOpeningTime}}</a></small>
                                    <br />
                                    <small><a href="#!">(Open Now***)</a></small>
                                    @* </span> *@
                                </div>
                                <!-- rating -->
                                <div class="mt-2">
                                    <!-- rating -->
                                    <small class="text-warning">
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-half"></i>
                                    </small><span class="ms-2">{{stores.commentRank/stores.commentCount}}</span>
                                    <!-- text --><span class="text-muted ms-1">({{stores.commentCount}} reviews)</span>
                                </div>
                                <div class="mt-2">
                                    <button class="btn btn-primary btn-sm" @@click="removeFromFavorites" v-if="this.isFavorite">
                                    @* <button style="border-style:none; color:white; background-color:darkgreen" @@click="removeFromFavorites" v-if="this.isFavorite"> *@
                                        <strong>取消收藏</strong>
                                    </button>
                                    <button class="btn btn-primary btn-sm" @@click="saveToFavorites" v-else>
                                        <strong>收藏</strong>
                                    </button>                                  
                                    <a href="#" class="btn btn-info btn-sm ms-2"><strong>分享</strong></a>
                                    <a href="#" class="btn btn-success btn-sm ms-2"><strong>導航</strong></a>
                                </div>
                            </div>

                        </div>

                        <hr />
                        <div>
                            <ul class="nav flex-column nav-links">
                                <!-- nav item -->
                                <li class="nav-item" v-for="categoryItem in stores.categoryList" v-on:click="categoriesFilter(categoryItem)">
                                    <a href="#!" class="nav-link">{{categoryItem}}</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-12 col-lg-9 col-md-8">

                        <div class="mb-8 d-lg-flex justify-content-lg-between rounded">

                            <div class="p-8">
                                <!-- img -->
                                <img :src="stores.photosPath" alt="Description of the image" class="img-fluid rounded">
                            </div>
                            <div class="align-self-center p-8">
                                <div class="mb-3">
                                    <h5>{{stores.description}}</h5>
                                </div>
                                <div class="position-relative">
                                    <input v-model.lazy="keyWords" type="search" class="form-control" placeholder="搜尋店家商品" @@keyup.enter="searchProducts">
                                    <span class="position-absolute end-0 top-0 mt-2 me-3">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search" >
                                            <circle cx="11" cy="11" r="8"></circle>
                                            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                                        </svg>
                                    </span>
                                </div>
                            </div>
                        </div>

                        <div class="d-md-flex justify-content-between mb-3 align-items-center">
                            <div>
                                <p class="mb-3 mb-md-0">{{productsQty}}項商品</p>
                            </div>
                            <div class="d-flex justify-content-md-between align-items-center">
                                <div class="me-2">
                                    <!-- select option -->
                                    <select class="form-select">
                                        <option selected>Show: 50</option>
                                        <option value="10">10</option>
                                        <option value="20">20</option>
                                        <option value="30">30</option>
                                    </select>
                                </div>
                                <div>
                                    <!-- select option -->
                                    <select class="form-select" v-model="sortingOptions">
                                        @* <option value="Featured">Sort by: Featured</option> *@
                                        <option value="PriceLowToHigh">價格: 低到高</option>
                                        <option value="PriceHighToLow">價格: 高到低</option>
                                        @* <option value="ReleaseDate">Release Date</option> *@
                                        <option value="QtyHighToLow">剩餘數量: 多到少</option>
                                        <option value="QtyLowToHigh">剩餘數量: 少到多</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <!-- row -->
                        <div class="row g-4 row-cols-xl-3 row-cols-lg-3 row-cols-2 row-cols-md-2 mt-2">
                            <div class="col  align-items-stretch" v-for="item in filteredProducts">
                                <!-- card -->
                                <div class="card card-product">
                                    <div class="card-body">
                                        <div class="text-center position-relative">
                                            <!-- badge-二期*** -->
                                            @* <div class="position-absolute top-0 start-0">
                                            <span class="badge bg-danger">Sale</span>
                                            </div> *@
                                            <a href="#!">
                                                <!-- img --><img :src="item.photoPath"
                                                                 alt="Grocery Ecommerce Template"
                                                                 class="mb-3 img-fluid rounded" />
                                            </a>
                                            <!-- btn action -->
                                            <div class="card-product-action">
                                                <a href="#!"
                                                   class="btn-action"
                                                   data-bs-toggle="modal"
                                                   data-bs-target="#quickViewModal">
                                                    <i class="bi bi-eye"
                                                       data-bs-toggle="tooltip"
                                                       data-bs-html="true"
                                                       title="Quick View"></i>
                                                </a>
                                                <a href="#!"
                                                   class="btn-action"
                                                   data-bs-toggle="tooltip"
                                                   data-bs-html="true"
                                                   title="Wishlist">
                                                    <i class="bi bi-heart"></i>
                                                </a>
                                                <a href="#!"
                                                   class="btn-action"
                                                   data-bs-toggle="tooltip"
                                                   data-bs-html="true"
                                                   title="Compare">
                                                    <i class="bi bi-arrow-left-right"></i>
                                                </a>
                                            </div>
                                        </div>
                                        <div class="text-small mb-1">
                                            <a href="#!" class="text-decoration-none text-muted"><small>{{item.categoryName}}</small></a>
                                        </div>
                                        <h2 class="fs-6">
                                            <a href="#!" class="text-inherit text-decoration-none">{{item.productName}}</a>
                                        </h2>
                                        <!-- Remaining Quantity -->
                                        <div class="mb-1">
                                            <small>剩餘數量: {{item.avalibleQty}}</small>
                                        </div>

                                        <!-- Estimated Pickup Time -->
                                        <div class="mb-1">
                                            <small>取貨期限: {{item.suggestPickUpTime}}</small>
                                        </div>

                                        <!-- price -->
                                        <div class="d-flex justify-content-between align-items-center mt-3">
                                            <div>
                                                <span class="text-dark">${{item.unitPrice}}</span>
                                                @****二期 <span class="text-decoration-line-through text-muted">$***</span> *@
                                            </div>
                                            
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- row -->
                        <div class="row mt-8">
                            <div class="col">
                                <!-- nav -->
                                <nav>
                                    <ul class="pagination">
                                        <li class="page-item disabled">
                                            <a class="page-link mx-1 "
                                               href="#"
                                               aria-label="Previous">
                                                <i class="feather-icon icon-chevron-left"></i>
                                            </a>
                                        </li>
                                        <li class="page-item">
                                            <a class="page-link mx-1 active" href="#">1</a>
                                        </li>
                                        <li class="page-item">
                                            <a class="page-link mx-1 text-body" href="#">2</a>
                                        </li>

                                        <li class="page-item">
                                            <a class="page-link mx-1 text-body" href="#">...</a>
                                        </li>
                                        <li class="page-item">
                                            <a class="page-link mx-1 text-body" href="#">12</a>
                                        </li>
                                        <li class="page-item">
                                            <a class="page-link mx-1 text-body"
                                               href="#"
                                               aria-label="Next">
                                                <i class="feather-icon icon-chevron-right"></i>
                                            </a>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Carousel wrapper -->
                <div id="carouselMultiItemExample" class="carousel slide carousel-dark text-center mt-15" data-mdb-ride="carousel">
                    <!-- Controls -->
                    <div class="d-flex justify-content-center mb-4">
                        <button class="carousel-control-prev position-relative" type="button"
                                data-mdb-target="#carouselMultiItemExample" data-mdb-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next position-relative" type="button"
                                data-mdb-target="#carouselMultiItemExample" data-mdb-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                    <!-- Inner -->
                    <div class="carousel-inner py-4">
                        <!-- Single item -->
                        <div v-for="(group, groupIndex) in groupedPeople" :key="groupIndex" class="carousel-item" :class="{ 'active': groupIndex === 0 }">

                            <div class="container">
                                <div class="row">
                                    <div class="col-lg-4" v-for="(person, personIndex) in group">

                                        <h5 class="mb-3">{{person.user}}</h5>
                                        <p>{{person.deliveryMethod}}</p>
                                        <p class="text-muted">
                                            <i class="fas fa-quote-left pe-2"></i>
                                            {{person.contents}}
                                        </p>
                                        <ul class="list-unstyled d-flex justify-content-center text-warning mb-0">
                                            <li><i class="fas fa-star fa-sm"></i></li>
                                            <li><i class="fas fa-star fa-sm"></i></li>
                                            <li><i class="fas fa-star fa-sm"></i></li>
                                            <li><i class="fas fa-star fa-sm"></i></li>
                                            <li><i class="fas fa-star fa-sm"></i></li>
                                        </ul>
                                    </div>

                                </div>
                            </div>
                        </div>

                    </div>
                    <!-- Inner -->
                </div>
                <!-- Carousel wrapper -->
            </div>
        </section>
    </main>

    <!-- Modal -->
    <div class="modal fade" id="quickViewModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body p-8">
                    <div class="position-absolute top-0 end-0 me-3 mt-3">
                        <button type="button"
                                class="btn-close"
                                data-bs-dismiss="modal"
                                aria-label="Close"></button>
                    </div>
                    <div class="row">
                        <div class="col-lg-6">
                            <!-- img slide -->
                            <div class="product productModal" id="productModal">
                                <div class="zoom"
                                     onmousemove="zoom(event)"
                                     style="
                  background-image: url(~/assets/images/products/product-single-img-1.jpg);
                ">
                                    <!-- img -->
                                    <img src="~/assets/images/products/product-single-img-1.jpg"
                                         alt="">
                                </div>
                                <div>
                                    <div class="zoom"
                                         onmousemove="zoom(event)"
                                         style="
                    background-image: url(~/assets/images/products/product-single-img-2.jpg);
                  ">
                                        <!-- img -->
                                        <img src="~/assets/images/products/product-single-img-2.jpg"
                                             alt="">
                                    </div>
                                </div>
                                <div>
                                    <div class="zoom"
                                         onmousemove="zoom(event)"
                                         style="
                    background-image: url(~/assets/images/products/product-single-img-3.jpg);
                  ">
                                        <!-- img -->
                                        <img src="~/assets/images/products/product-single-img-3.jpg"
                                             alt="">
                                    </div>
                                </div>
                                <div>
                                    <div class="zoom"
                                         onmousemove="zoom(event)"
                                         style="
                    background-image: url(~/assets/images/products/product-single-img-4.jpg);
                  ">
                                        <!-- img -->
                                        <img src="~/assets/images/products/product-single-img-4.jpg"
                                             alt="">
                                    </div>
                                </div>
                            </div>
                            <!-- product tools -->
                            <div class="product-tools">
                                <div class="thumbnails row g-3" id="productModalThumbnails">
                                    <div class="col-3" class="tns-nav-active">
                                        <div class="thumbnails-img">
                                            <!-- img -->
                                            <img src="~/assets/images/products/product-single-img-1.jpg"
                                                 alt="">
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="thumbnails-img">
                                            <!-- img -->
                                            <img src="~/assets/images/products/product-single-img-2.jpg"
                                                 alt="">
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="thumbnails-img">
                                            <!-- img -->
                                            <img src="~/assets/images/products/product-single-img-3.jpg"
                                                 alt="">
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="thumbnails-img">
                                            <!-- img -->
                                            <img src="~/assets/images/products/product-single-img-4.jpg"
                                                 alt="">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="ps-lg-8 mt-6 mt-lg-0">
                                <a href="#!" class="mb-4 d-block">Bakery Biscuits</a>
                                <h2 class="mb-1 h1">Napolitanke Ljesnjak</h2>
                                <div class="mb-4">
                                    <small class="text-warning">
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-half"></i>
                                    </small><a href="#" class="ms-2">(30 reviews)</a>
                                </div>
                                <div class="fs-4">
                                    <span class="fw-bold text-dark">$32</span>
                                    <span class="text-decoration-line-through text-muted">$35</span><span><small class="fs-6 ms-2 text-danger">26% Off</small></span>
                                </div>
                                <hr class="my-6">
                                <div class="mb-4">
                                    <button type="button" class="btn btn-outline-secondary">
                                        250g
                                    </button>
                                    <button type="button" class="btn btn-outline-secondary">
                                        500g
                                    </button>
                                    <button type="button" class="btn btn-outline-secondary">
                                        1kg
                                    </button>
                                </div>
                                <div>

                                    <!-- input -->
                                    <div class="input-group input-spinner  ">
                                        <input type="button" value="-" class="button-minus  btn  btn-sm " data-field="quantity">
                                        <input type="number" step="1" max="10" value="1" name="quantity" class="quantity-field form-control-sm form-input   ">
                                        <input type="button" value="+" class="button-plus btn btn-sm " data-field="quantity">
                                    </div>
                                </div>
                                <div class="mt-3 row justify-content-start g-2 align-items-center">

                                    <div class="col-lg-4 col-md-5 col-6 d-grid">
                                        <!-- button -->
                                        <!-- btn -->
                                        <button type="button" class="btn btn-primary">
                                            <i class="feather-icon icon-shopping-bag me-2"></i>Add to
                                            cart
                                        </button>
                                    </div>
                                    <div class="col-md-4 col-5">
                                        <!-- btn -->
                                        <a class="btn btn-light"
                                           href="#"
                                           data-bs-toggle="tooltip"
                                           data-bs-html="true"
                                           aria-label="Compare">
                                            <i class="bi bi-arrow-left-right"></i>
                                        </a>
                                        <a class="btn btn-light"
                                           href="#!"
                                           data-bs-toggle="tooltip"
                                           data-bs-html="true"
                                           aria-label="Wishlist">
                                            <i class="feather-icon icon-heart"></i>
                                        </a>
                                    </div>
                                </div>
                                <hr class="my-6">
                                <div>
                                    <table class="table table-borderless">
                                        <tbody>
                                            <tr>
                                                <td>Product Code:</td>
                                                <td>FBB00255</td>
                                            </tr>
                                            <tr>
                                                <td>Availability:</td>
                                                <td>In Stock</td>
                                            </tr>
                                            <tr>
                                                <td>Type:</td>
                                                <td>Fruits</td>
                                            </tr>
                                            <tr>
                                                <td>Shipping:</td>
                                                <td>
                                                    <small>
                                                        01 day shipping.<span class="text-muted">( Free pickup today)</span>
                                                    </small>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    @section Scripts{
        <script src="https://unpkg.com/vue@3.2.36/dist/vue.global.js"></script>
        <script>
            // var baseAddress = "https://localhost:7042";
            var isLoggedIn = ('@User.Identity.IsAuthenticated' == "True");
            const storeProductApp = Vue.createApp({
                data: function () {
                    return {
                        products: [],
                        stores: [],
                        storeName: "",
                        comment: [],
                        selectedCategory: null,
                        storeCategoryList: [],
                        sortingOptions: 'PriceLowToHigh',
                        productsQty: 0,
                        isFavorite: false,
                        searchKeyWords:""

                    }
                },
                computed: {                  
                            
                    groupedPeople() {
                        const groupSize = 3;
                        const grouped = [];
                        for (let i = 0; i < this.comment.length; i += groupSize) {
                            grouped.push(this.comment.slice(i, i + groupSize));
                        }
                        return grouped;
                    },

                    filteredProducts() {
                        // let filteredProducts = [...this.products];
                        let filteredProducts = this.products;
                        // filtering based on selected category
                        if (this.selectedCategory && this.selectedCategory !== "全部") {
                            // this.searchKeyWords = "";//改
                            filteredProducts = filteredProducts.filter(item => item.categoryName === this.selectedCategory);
                            // this.selectedCategory = "";
                        }
                        // if (this.selectedCategory) {
                        //     this.searchKeyWords = "";
                        //     if (this.selectedCategory !== "全部") {
                        //         filteredProducts = filteredProducts.filter(item => item.categoryName === this.selectedCategory);
                        //     }                         
                        // }
                        //search filter
                        if (this.searchKeyWords &&this.searchKeyWords.trim() !== "") {
                            // this.selectedCategory = "";//改
                            const searchQuery = this.searchKeyWords.toLowerCase();
                            filteredProducts = filteredProducts.filter(item =>
                                item.productName.toLowerCase().includes(searchQuery) ||
                                item.categoryName.toLowerCase().includes(searchQuery)
                            );
                            // this.searchKeyWords = "";
                        }
                        // sorting based on sortingOptions
                        if (this.sortingOptions === "PriceLowToHigh") {
                            filteredProducts = filteredProducts.sort((a, b) => a.unitPrice - b.unitPrice);
                        } else if (this.sortingOptions === "PriceHighToLow") {
                            filteredProducts = filteredProducts.sort((a, b) => b.unitPrice - a.unitPrice);
                        } else if (this.sortingOptions === "QtyLowToHigh") {
                            filteredProducts = filteredProducts.sort((a, b) => a.avalibleQty - b.avalibleQty);
                        } else if (this.sortingOptions === "QtyHighToLow") {
                            filteredProducts = filteredProducts.sort((a, b) => b.avalibleQty - a.avalibleQty);
                        }
                        
                        this.productsQty = filteredProducts.length;
                        return filteredProducts;
                    }
                },
                mounted: function () {
                    let _this = this;
                    _this.getStoreInfo();
                },
                methods: {
                    categoriesFilter(category) {
                        this.searchKeyWords = "";
                        this.selectedCategory = category;
                    },
                    searchProducts() {
                        this.selectedCategory = "";
                        this.searchKeyWords = this.keyWords;
                    },
                    getFavoriteStatus() {
                        let _this = this;
                        const storeId = "S001"
                        // const userId = "U001"
                        fetch(`/api/StoreProductsapi/favorite/status/${storeId}`)
                            .then(response => {
                                if (!response.ok) {
                                    throw new Error(`${response.status}`);
                                }
                                // return response;
                                return response.json()
                            })                          
                            .then(result => {
                                // _this.isFavorite = result;
                                _this.isFavorite = result.isFavorite;
                            })
                            .catch(error => {
                                console.error('Error', error);
                            });
                    },
                    saveToFavorites() {
                        if (isLoggedIn) {
                            const storeId = "S001";
                            // const userId = "U001";
                            let raw = {
                                // userId: userId,
                                storeId: storeId,
                            }
                            var requestOptions = {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                body: JSON.stringify(raw),
                            };
                            fetch(`/api/StoreProductsapi/favorite/add`,
                                requestOptions
                            )
                                .then(response => {
                                    if (!response.ok) {
                                        throw new Error(`${response.status}`);
                                    }
                                    return response.text();
                                })
                                .then(result => {
                                    alert(result);
                                    this.isFavorite = true;
                                })
                                .catch(error => {
                                    console.error('Error', error);
                                });
                        }
                        else {
                            alert("請先登入")
                        }
                       
                    },
                    removeFromFavorites() {
                        const storeId = "S001"; 
                        const userId = "U001"; 
                        var raw = JSON.stringify({ userId, storeId });
                        const requestOptions = {
                            method: 'DELETE',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: raw,
                        };
                        fetch(`/api/StoreProductsapi/favorite/remove`, requestOptions)
                            .then(response => {
                                if (!response.ok) {
                                    throw new Error(`${response.status}`);
                                }
                                return response.text(); 
                            })
                            .then(result => {
                                alert(result);
                                this.isFavorite = false;
                            })
                            .catch(error => {
                                console.error('Error', error);
                            });
                    },
                    getStoreInfo() {
                        let _this = this;
                        let storeId = "S001"
                        fetch(`/api/StoreProductsapi/${storeId}`, { method: "GET" })
                            .then(response => {
                                if (!response.ok) {
                                    throw new Error(`${response.status}`);
                                }
                                return response.json();
                            })
                            .then(data => {
                                // alert(JSON.stringify(data));
                                _this.stores = data[0];
                                _this.products = data[0].products;
                                _this.comment = data[0].comment;                              
                                _this.storeCategoryList = [..._this.stores.categoryList].filter(category => category !== "其他")
                                _this.stores.categoryList.unshift("全部");
                                if (isLoggedIn) {
                                    _this.getFavoriteStatus();
                                }                              
                                // console.table(_this.stores)
                            }).catch(error => {
                                alert(error);
                                console.log('error', error);
                            });
                    },
                    // searchProducts() {
                    //     let _this = this;
                    //     // alert(_this.searchKeyWords)
                    //     fetch(`${baseAddress}/api/StoreProductsapi/Search?query=${_this.searchKeyWords}`)
                    //         .then(response => {
                    //             if (!response.ok) {
                    //                 throw new Error(`${response.status}`);
                    //             }
                    //             return response.json()
                    //         })
                    //         .then(result => {
                    //             alert(JSON.stringify(result))
                    //             _this.products = result.products;
                    //             _this.stores.categoryList = result.categories;
                    //             _this.stores.categoryList.unshift("全部");
                    //         })
                    //         .catch(error => {
                    //             console.error('Error', error);
                    //         });
                    // }
                }
            }).mount("#storeProductsApp")
        </script>

        <!-- Javascript-->
        <!-- Libs JS -->
        <script src="~/assets/libs/jquery/dist/jquery.min.js"></script>
        <script src="~/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
        <script src="~/assets/libs/simplebar/dist/simplebar.min.js"></script>

        <!-- Theme JS -->
        <script src="~/assets/js/theme.min.js"></script>
        <script src="~/assets/libs/tiny-slider/dist/min/tiny-slider.js"></script>
        <script src="~/assets/js/vendors/tns-slider.js"></script>
        <script src="~/assets/js/vendors/increment-value.js"></script>
        @* Carousel *@
        <!-- MDB -->
        <script type="text/javascript"
                src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.4.2/mdb.min.js"></script>
    }

</body>

